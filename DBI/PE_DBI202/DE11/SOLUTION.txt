--Q1
CREATE TABLE BRANCH
(
  BCITY VARCHAR(20),
  BNAME VARCHAR(20),
  BRID INT,
  PRIMARY KEY (BRID)
);

CREATE TABLE EMPLOYEE
(
  PHONE VARCHAR(20),
  ENAME VARCHAR(20),
  EMPID INT ,
  MANAGE_EMPID INT,
  PRIMARY KEY (EMPID),
  FOREIGN KEY (MANAGE_EMPID) REFERENCES EMPLOYEE(EMPID)
);

CREATE TABLE WORKAT
(
  SINCE DATE,
  SENIORITY INT ,
  EMPID INT,
  BRID INT ,
  PRIMARY KEY (EMPID, BRID),
  FOREIGN KEY (EMPID) REFERENCES EMPLOYEE(EMPID),
  FOREIGN KEY (BRID) REFERENCES BRANCH(BRID)
);

CREATE TABLE EMPLOYEE_CHILDREN
(
  CHILDREN VARCHAR(20),
  EMPID INT,
  PRIMARY KEY (CHILDREN, EMPID),
  FOREIGN KEY (EMPID) REFERENCES EMPLOYEE(EMPID)
);
--Q2
SELECT EMPLOYEE.Bdate,EMPLOYEE.Address
FROM EMPLOYEE
WHERE EMPLOYEE.Fname+' '+EMPLOYEE.Lname like 'John Smith'
--Q3
SELECT E1.Fname,E1.Lname
FROM EMPLOYEE E1
INNER JOIN EMPLOYEE E2 ON E1.Ssn=E2.Super_ssn
GROUP BY E1.Fname,E1.Lname
HAVING COUNT(E2.Super_ssn)>6
--Q4
SELECT EMPLOYEE.Lname,EMPLOYEE.Fname
FROM EMPLOYEE
WHERE EMPLOYEE.Salary>ALL(
SELECT EMPLOYEE.Salary
FROM EMPLOYEE WHERE EMPLOYEE.Dno=5
)
--Q5
SELECT a.Dnumber, a.Dname, c.NumberOfEmployees
FROM
  (SELECT DEPARTMENT.Dnumber, DEPARTMENT.Dname
  FROM DEPARTMENT
  INNER JOIN EMPLOYEE ON DEPARTMENT.Dnumber = EMPLOYEE.Dno
  GROUP BY DEPARTMENT.Dnumber, DEPARTMENT.Dname
  HAVING COUNT(EMPLOYEE.Ssn) > 5) AS a
INNER JOIN
  (SELECT DEPARTMENT.Dnumber, DEPARTMENT.Dname, COUNT(EMPLOYEE.Ssn) AS NumberOfEmployees
  FROM DEPARTMENT
  INNER JOIN EMPLOYEE ON DEPARTMENT.Dnumber = EMPLOYEE.Dno
  WHERE EMPLOYEE.Salary > 40000
  GROUP BY DEPARTMENT.Dnumber, DEPARTMENT.Dname) AS c
ON a.Dname = c.Dname AND a.Dnumber = c.Dnumber
order by NumberOfEmployees desc


